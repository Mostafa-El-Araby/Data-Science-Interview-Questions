SELECT
  COUNT(DISTINCT CONCAT(t1.transaction_id, t2.transaction_id)) AS unique_pairs
FROM transactions AS t1 INNER JOIN transactions AS t2
ON t1.user_id = t2.user_id
WHERE t1.product_id < t2.product_id;